# =============================================================================
# MRP Monorepo - Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values.
# For production (Railway), set these as service environment variables.
#
# See README.md for detailed documentation and Railway service mappings.
# =============================================================================

# -----------------------------------------------------------------------------
# Shared / Common Variables
# -----------------------------------------------------------------------------

# Node environment: development | production | test
NODE_ENV=development

# Logging level: trace | debug | info | warn | error | fatal
LOG_LEVEL=info

# Default tenant slug (used when X-MRP-Tenant-Slug header is not provided)
DEFAULT_TENANT_SLUG=dev

# -----------------------------------------------------------------------------
# API Service (apps/api)
# -----------------------------------------------------------------------------

# Database connection string (PostgreSQL)
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://user:password@localhost:5432/mrp

# Redis connection string (for BullMQ queue)
# Format: redis://user:password@host:port/db
REDIS_URL=redis://localhost:6379/0

# GitLab Configuration
GITLAB_BASE_URL=https://gitlab.com
GITLAB_TOKEN=glpat-xxxxxxxxxxxxxxxxxxxx
GITLAB_WEBHOOK_SECRET=your-webhook-secret-here

# Public URL of the API service (used for webhook callbacks, etc.)
# Example: https://api.yourdomain.com
APP_PUBLIC_URL=http://localhost:3001

# Storage Configuration (S3-compatible)
STORAGE_PROVIDER=s3
STORAGE_REGION=us-east-1
STORAGE_BUCKET=your-bucket-name
STORAGE_ACCESS_KEY_ID=your-access-key-id
STORAGE_SECRET_ACCESS_KEY=your-secret-access-key
# Optional: Custom S3 endpoint (for MinIO, DigitalOcean Spaces, etc.)
# STORAGE_ENDPOINT=https://s3.example.com

# Portal Authentication
# Token used by portal to authenticate with API (X-MRP-Admin-Token header)
PORTAL_ADMIN_TOKEN=your-admin-token-here

# Server Configuration
PORT=3001
HOST=0.0.0.0

# CORS Configuration
# Comma-separated list of allowed origins, or use PORTAL_ORIGIN for single origin
# PORTAL_ORIGINS=http://localhost:3000,https://portal.yourdomain.com
# PORTAL_ORIGIN=http://localhost:3000

# Debug Endpoints (development only)
# ENABLE_DEBUG_ENDPOINTS=true

# -----------------------------------------------------------------------------
# Worker Service (apps/worker)
# -----------------------------------------------------------------------------

# Redis connection string (required for BullMQ)
# Must match API service REDIS_URL
# REDIS_URL=redis://localhost:6379/0

# Database connection string (optional, but recommended)
# If not set, database features will be unavailable
# DATABASE_URL=postgresql://user:password@localhost:5432/mrp

# GitLab Configuration (optional, inherited from job payload)
# GITLAB_BASE_URL=https://gitlab.com
# GITLAB_TOKEN=glpat-xxxxxxxxxxxxxxxxxxxx

# AI Self-Test (development only)
# AI_SELF_TEST=true

# -----------------------------------------------------------------------------
# Portal Service (apps/portal)
# -----------------------------------------------------------------------------

# Public API base URL (used by Next.js at build time)
# In development, defaults to http://localhost:3001
# In production, must be set explicitly
NEXT_PUBLIC_API_BASE_URL=http://localhost:3001

# Default tenant slug (optional, can be overridden in UI)
# NEXT_PUBLIC_DEFAULT_TENANT_SLUG=dev

# Portal admin token (optional, can be set in UI)
# NEXT_PUBLIC_PORTAL_ADMIN_TOKEN=your-admin-token-here

# -----------------------------------------------------------------------------
# AI / LLM Configuration (Optional)
# -----------------------------------------------------------------------------

# Enable AI features (set to "true" to enable)
# If enabled, OPENAI_API_KEY must be set
AI_ENABLED=false

# OpenAI API key (required if AI_ENABLED=true)
# OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
